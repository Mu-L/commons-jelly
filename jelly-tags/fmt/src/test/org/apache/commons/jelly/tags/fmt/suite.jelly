<?xml version="1.0"?>
<test:suite xmlns:j="jelly:core" 
			xmlns:fmt="jelly:fmt"
			xmlns:m="jelly:ant"
			xmlns:b="jelly:beanshell" 
            xmlns:test="jelly:junit" 
            xmlns:log="jelly:log">

	<test:case name="testSimple" xmlns="dummy">
		<j:set var="keyvar" value="key2"/>
		<fmt:bundle basename="org.apache.commons.jelly.tags.fmt.abc">
			<fmt:message key="key1" var="dummyKey1"/>
			<fmt:message var="dummyKey2">${keyvar}</fmt:message>
			<fmt:message var="dummyKeyInvalid">invalid.key</fmt:message>
		</fmt:bundle>

		<m:echo>i10n content is </m:echo>
		<m:echo>key1: '${dummyKey1}'</m:echo>
		<m:echo>key2: '${dummyKey2}'</m:echo>
		<m:echo>keyInvalid: '${dummyKeyInvalid}'</m:echo>
    
		<test:assertEquals expected="value1" actual="${dummyKey1}" />
		<test:assertEquals expected="value2" actual="${dummyKey2}" />
		<test:assertEquals expected="???invalid.key???" actual="${dummyKeyInvalid}" />
	</test:case>
	
	<test:case name="testParam" xmlns="dummy">
		<j:set var="keyvar" value="key3"/>
		<j:set var="valuevar" value="param1"/>
		<fmt:bundle basename="org.apache.commons.jelly.tags.fmt.abc">
			<fmt:message var="dummyKey3">${keyvar}<fmt:param value="${valuevar}"/>
				<fmt:param value="param2"/>
			</fmt:message>
		</fmt:bundle>

		<m:echo>i10n content is </m:echo>
		<m:echo>key3: '${dummyKey3}'</m:echo>
    
		<test:assertEquals expected="value3 param1 param2" actual="${dummyKey3}" />
	</test:case>


	<test:case name="testPrefix" xmlns="dummy">
		<fmt:bundle basename="org.apache.commons.jelly.tags.fmt.xyz" prefix="123.">
			<fmt:message key="key1" var="dummyKey1"/>
			<fmt:message var="dummyKey2">key2</fmt:message>
			<fmt:message var="dummyKeyInvalid">invalid.key</fmt:message>
		</fmt:bundle>

		<m:echo>i10n content is </m:echo>
		<m:echo>key1: '${dummyKey1}'</m:echo>
		<m:echo>key2: '${dummyKey2}'</m:echo>
		<m:echo>keyInvalid: '${dummyKeyInvalid}'</m:echo>
    
		<test:assertEquals expected="value1" actual="${dummyKey1}" />
		<test:assertEquals expected="value2" actual="${dummyKey2}" />
		<test:assertEquals expected="???123.invalid.key???" actual="${dummyKeyInvalid}" />
	</test:case>
	
	<test:case name="testSetLocale" xmlns="dummy">
		<fmt:setLocale value="zh"/>
		<fmt:bundle basename="org.apache.commons.jelly.tags.fmt.xyz" prefix="123.">
			<fmt:message key="key1" var="dummyKey1"/>
			<fmt:message var="dummyKey2">key2</fmt:message>
			<fmt:message var="dummyKeyInvalid">invalid.key</fmt:message>
		</fmt:bundle>

		<m:echo>i10n content is </m:echo>
		<m:echo>key1: '${dummyKey1}'</m:echo>
		<m:echo>key2: '${dummyKey2}'</m:echo>
		<m:echo>keyInvalid: '${dummyKeyInvalid}'</m:echo>
    
		<test:assertEquals expected="value1-zh" actual="${dummyKey1}" />
		<test:assertEquals expected="value2-zh" actual="${dummyKey2}" />
		<test:assertEquals expected="???123.invalid.key???" actual="${dummyKeyInvalid}" />
	</test:case>
</test:suite>
